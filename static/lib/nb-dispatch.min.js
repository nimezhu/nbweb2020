// https://vis.nucleome.org v0.0.2 Copyright 2019 Xiaopeng Zhu
!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(n.nb=n.nb||{})}(this,function(n){"use strict";var e={value:function(){}};function o(){for(var n,e=0,o=arguments.length,c={};e<o;++e){if(!(n=arguments[e]+"")||n in c)throw new Error("illegal type: "+n);c[n]=[]}return new t(c)}function t(n){this._=n}function c(n,e){for(var o,t=0,c=n.length;t<c;++t)if((o=n[t]).name===e)return o.value}function i(n,o,t){for(var c=0,i=n.length;c<i;++c)if(n[c].name===o){n[c]=e,n=n.slice(0,c).concat(n.slice(c+1));break}return null!=t&&n.push({name:o,value:t}),n}function s(n,e,o,t){try{var c=new BroadcastChannel(n);e.on("sendMessage.chan",function(n){c.postMessage(n)}),c.onmessage=function(n){var o=n.data;e.call("receiveMessage",this,o)},e.on("_disconnect",function(n){e.on("sendMessage.chan",null),c.close(),onclose()}),o.connection="Channel",o.id=n,t(o)}catch(n){console.log("your browser doesn't support BroadCastChannel"),o.connection="No Connection",o.id="",t(o)}}function r(n,e,o,t,c,i){var r=e,a=n,u=function(){s(a,o,t,c)};try{window.chrome.runtime.sendMessage(r,{message:"version"},function(n){n?n.version&&f():u()})}catch(n){u()}var f=function(){!function(n,e,o,t,c,i){var s=window.chrome.runtime.connect(n);s.postMessage({chanId:e}),o.on("sendMessage.apps",function(n){s.postMessage(n)}),s.onMessage.addListener(function(n){o.call("receiveMessage",this,{code:n.code,data:JSON.stringify(n.data)})}),s.onDisconnect.addListener(function(e){console.log("disconnect to extension ",n),o.on("sendMessage.apps",null),i()}),o.on("_disconnect",function(e){console.log("disconnect to extension ",n),o.on("sendMessage.apps",null),i(),s.disconnect()}),t.connection="Extension",t.id=n,c(t)}(e,n,o,t,c,i)}}t.prototype=o.prototype={constructor:t,on:function(n,e){var o,t,s=this._,r=(t=s,(n+"").trim().split(/^|\s+/).map(function(n){var e="",o=n.indexOf(".");if(o>=0&&(e=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:e}})),a=-1,u=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<u;)if(o=(n=r[a]).type)s[o]=i(s[o],n.name,e);else if(null==e)for(o in s)s[o]=i(s[o],n.name,null);return this}for(;++a<u;)if((o=(n=r[a]).type)&&(o=c(s[o],n.name)))return o},copy:function(){var n={},e=this._;for(var o in e)n[o]=e[o].slice();return new t(n)},call:function(n,e){if((o=arguments.length-2)>0)for(var o,t,c=new Array(o),i=0;i<o;++i)c[i]=arguments[i+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(i=0,o=(t=this._[n]).length;i<o;++i)t[i].value.apply(e,c)},apply:function(n,e,o){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var t=this._[n],c=0,i=t.length;c<i;++c)t[c].value.apply(e,o)}},n.dispatch=function(){var n,e="djcdicpaejhpgncicoglfckiappkoeof",t="cnbChan01",c={connection:"No Connection",id:""},i=o("sendMessage","receiveMessage","_disconnect");i.on("_disconnect.status",function(){c.connection="No Connection",c.id=""}),n=arguments.length>0?o.apply(this,arguments):o.apply(this,["update","brush"]);var s=function(){},a=function(){s()},u=function(){};return u.connect=function(n){r(t,e,i,c,"function"==typeof n?function(e){s(),n(e)}:function(n){s()},a)},u.disconnect=function(n){i.call("_disconnect",this,{})},u.close=function(n){i.call("_disconnect",this,{})},u.dispatch=function(){return i},u.extId=function(n){return arguments.length?(e=n,u):e},u.chanId=function(n){return arguments.length?(t=n,u):t},u.status=function(){return c},u.onchange=function(n){return arguments.length?(s=n,u):s},u.on=function(e,o){var t=e.split(".")[0]||"";"sendMessage"===t||"receiveMessage"===t?i.on(e,o):(i.on("receiveMessage".concat(".").concat(e),function(n){n.code===t&&o(JSON.parse(n.data))}),n.on(e,function(n){o(n)}))},u.call=function(e,o,t){"sendMessage"===e||"receiveMessage"===e?i.call(e,o,t):(i.call("sendMessage",o,{code:e,data:JSON.stringify(t)}),n.call(e,o,t))},u},Object.defineProperty(n,"__esModule",{value:!0})});
